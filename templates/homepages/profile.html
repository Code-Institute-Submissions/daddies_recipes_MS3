{% extends 'base/base.html' %}
{% block content %}
<div class="parallax-container">
	<div class="parallax"><img src="static/images/family.jpg" alt="family-meal"></div>

	</div>
	<div class="container">
		<h1 class="main-heading">Welcome {{ session.user }}!</h1>
		<div class="row">

			<div class="col s12 welcome-text">
				<p> Feel free To Add, Delete and Edit Recipes. But Please be respectful of other users recipes. </p>
				{% with messages = get_flashed_messages() %}
				{% if messages %}
				{% for message in messages %}
				<p class="welcome-text">{{ message }}</p>
				{% endfor %}
				{% endif %}
				{% endwith %}
			</div>
		</div>
		<div class="row card-pannel ">
			<form method="POST" action="{{ url_for('search') }}" class="col s12">
				<div class="row valign-wrapper center-align">
					<div class="input-field col s12 m8">
						<input type="text" id="query" name="query" class="validate"  minlength="3" required>
						<label for="query">Search Recipes</label>
					</div>
					<div class="col s12 m4">
						<a href="{{url_for('profile')}}" class="red btn text-shadow">Reset</a>
						<button type="submit" class="light-blue darken-1 btn text-shadow">
    <i class="material-icons left">search</i> 
    </button>
					</div>
				</div>
			</form>
		</div>

		<ul class="collapsible z-depth-5">
			{% for recipe in recipes %}
			<li>
				<div class="collapsible-header ">
					<div class="col s3">
						<i class="material-icons">expand_more</i>
						<!--------delete function to easily delete a recipe if it doesnt suit the needs of the webiste or if someone 
                        has a nicer version -->
						{% if session.user|lower == recipe.posted_by|lower %}
						<a href="{{url_for('edit_recipe', recipe_id=recipe._id)}}"
							class="btn-floating btn-large waves-effect waves-light blue">Edit</a>
						<a class="btn-floating btn-large waves-effect waves-light red modal-trigger"
							href="#modal1">Delete</a>

						<!-- Modal Structure -->
						<div id="modal1" class="modal">
							<div class="modal-content">
								<h4>Are you sure you want to Delete?</h4>
							</div>
							<div class="modal-footer">
								<a href="{{url_for('delete_recipe', recipe_id=recipe._id)}}"
									class="modal-close waves-effect waves-green btn-flat">Yes</a>
								<a class="modal-close waves-effect waves-green btn-flat">No</a>
							</div>
						</div>
						{% endif %}
					</div>
					<div class="recipe_header col s9">
						<strong>Recipe:</strong> {{recipe.recipe_name}} - <strong>Time to make:</strong>
						{{recipe.time_to_make}}
					</div>
				</div>
				<div class="collapsible-body">
					<div>
						<img src="{{recipe.image}}" alt="image"  class="responsive-img center materialboxed">
     </div>
						<br>
						<h3 class="headers">Ingredients</h3>
						<ul>
							<!---after searching online i came across splitlines() method and deciede to try a for loop-->
							{% for newline in recipe.ingredients.splitlines() %}
							<li class="black-text">{{newline}}</li>
                            <br>
							{% endfor %}
						</ul>
						<br>
						<br>
						<h3 class="headers">Method</h3>
						<ul>
							{% for newline in recipe.method.splitlines() %}
							<li class="black-text">{{newline}}</li>
                            <br>
							{% endfor %}
						</ul>
						<br>
						<br>
						<h3 class="headers">Posted By</h3>
						<p class="black-text">{{recipe.posted_by}}</p>
					</div>
			</li>
			{% endfor %}
		</ul>

	</div>
	{% endblock %}